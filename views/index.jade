!!!5
html
  head
    meta(name='viewport', content='width=device-width, initial-scale=1.0')
    title #{title} - My Site
    link(rel='stylesheet', href='/css/bootstrap.min.css')
    link(rel='stylesheet', href='/css/jquery-ui.css')
    link(rel='stylesheet', href='/css/font-awesome.min.css')
    link(rel='stylesheet', href='/css/jquery.gridster.min.css')

    link(rel='stylesheet', href='/css/fixes.css')
    link(rel='stylesheet', href='/css/delineate.css')
    link(rel='stylesheet', href='/css/chartled.css')

    script(type='text/javascript', src='/javascripts/deps/jquery-1.9.1.js')
    script(type='text/javascript', src='/javascripts/deps/jquery-ui.js')
    script(type='text/javascript', src='/javascripts/chartled/deps/d3.v2.min.js')
    script(type='text/javascript', src='/javascripts/chartled/deps/delineate.js')
    script(type='text/javascript', src='/js/bootstrap.min.js')
    script(type='text/javascript', src='/js/bootbox.min.js')
    script(type='text/javascript', src='/javascripts/chartled/builder/chartdFunctions.js')
    script(type='text/javascript', src='/metrics')
    script(type='text/javascript', src='/javascripts/chartled/ChartledDefinition.js')
    script(type='text/javascript', src='/javascripts/chartled/Clock.js')
    script(type='text/javascript', src='/javascripts/chartled/TimeKeeper.js')
    script(type='text/javascript', src='/javascripts/chartled/viewer/chartled.js')
    script(type='text/javascript', src='/javascripts/chartled/deps/jquery.gridster.js')
    script(type='text/javascript', src='/javascripts/chartled/deps/rangy-core.js')
    script(type='text/javascript', src='/javascripts/chartled/deps/hallo.js')
    script(type='text/javascript', src='/javascripts/chartled/chartles/BaseChartle.js')
    script(type='text/javascript', src='/javascripts/chartled/chartles/MetricEditor.js')
    script(type='text/javascript', src='/javascripts/chartled/chartles/text/Renderer.js')
    script(type='text/javascript', src='/javascripts/chartled/chartles/text/Editor.js')
    script(type='text/javascript', src='/javascripts/chartled/chartles/chart/Renderer.js')
    script(type='text/javascript', src='/javascripts/chartled/chartles/chart/Editor.js')
    script(type='text/javascript', src='/javascripts/chartled/chartles/DashingChartle.js')
    script(type='text/javascript', src='/javascripts/chartled/chartles/clock/Renderer.js')
    script(type='text/javascript', src='/javascripts/chartled/chartles/clock/Editor.js')
    script(type='text/javascript', src='/javascripts/chartled/chartles/number/Renderer.js')
    script(type='text/javascript', src='/javascripts/chartled/chartles/number/Editor.js')
    script(type='text/javascript', src='/javascripts/chartled/chartles/spacer/Renderer.js')
    script(type='text/javascript', src='/javascripts/chartled/deps/jquery.boxfit.js')

  body#index
    div#left
    div#right
    div#top
    div#bottom
    div.container
      nav.navbar.navbar-inverse.navbar-fixed-top(role="navigation")
        .navbar-header
          button.navbar-toggle(type="button", data-toggle="collapse", data-target="#chartled-navbar-collapse-1")
          span.sr-only Toggle navigation
          span.icon-bar
          span.icon-bar
          span.icon-bar
          a.navbar-brand(href="#") Chartled
        div#chartled-navbar-collapse-1.collapse.navbar-collapse
          ul.nav.navbar-nav
            li.dropdown
              a.dropdown-toggle(href="#", data-toggle="dropdown") Utils
                b.caret
              ul.dropdown-menu
                li
                  a(href="#", onclick="importChartles()") Import
                li
                  a(href="#", onclick="exportChartles()") Export
            li.dropdown
              a.dropdown-toggle(href="#", data-toggle="dropdown") Chartles
                b.caret
              ul.dropdown-menu
                li
                  a(href='#', onclick="var c=addNewChart([]); c.configureChart()") Create new Chart
                li
                  a(href='#', onclick="addNewClock();") Create new Clock
                li
                  a(href='#', onclick="addNewTextBox()") Create new Textbox
                li
                  a(href='#', onclick="addNewSpacer()") Create new Spacer
            .btn-group.navbar-left(data-toggle="buttons")
              label.btn.btn-xs.btn-primary.navbar-btn(for="pageModeReadOnly")
                i.fa.fa-lock
                |  Read-Only
                input#pageModeReadOnly(type="radio", name="pageModeOptions")
              label.btn.btn-xs.btn-success.navbar-btn(for="pageModeLayout")
                i.fa.fa-arrows
                |  Layout
                input#pageModeLayout(type="radio", name="pageModeOptions", )
              label.btn.btn-xs.btn-warning.navbar-btn(for="pageModeOptions")
                i.fa.fa-pencil
                |  Content
                input#pageModeContent(type="radio", name="pageModeOptions")
      div#contents
        span From  &nbsp;
        input#from(value='now - 30 minutes')
        span   &nbsp;To &nbsp;
        input#to(value='now')

  script(type='text/javascript')
    var page_mode= "readOnly"; // readOnly, layout, content

    $(function() {
      $('.btn').button()
      addNewChart( [{ renderer:'line', value:'sin("Foo")' }] );
      addNewChart( [{ renderer:'line', value:'sin("Bar",4)' }] );
      addNewChart( [{ renderer:'line', value:'stats.statsd.ceres.flushTime' }] );

      $("#pageModeReadOnly").button('toggle')
      // Start in read-only mode
      setPageModeReadOnly();

      $("#pageModeReadOnly").on("change", setPageModeReadOnly)
      $("#pageModeLayout").on("change", setPageModeLayout)
      $("#pageModeContent").on("change", setPageModeContent)
    });

    function updatePageCss() {
      $("body").removeClass("pageMode-readonly");
      $("body").removeClass("pageMode-layout");
      $("body").removeClass("pageMode-content");
      $("body").addClass("pageMode-" + page_mode);
    }

    function setPageModeReadOnly() {
      page_mode= "readOnly";
      layout.disable();
      layout.disable_resize();
      $( ".text .realValue" ).hallo({editable: false});
      updatePageCss();
    }

    function setPageModeLayout() {
      page_mode= "layout";
      layout.enable();
      layout.enable_resize();
      $( ".text .realValue" ).hallo({editable: false});
      updatePageCss();
    }

    function setPageModeContent() {
        page_mode= "content";
        layout.disable();
        layout.disable_resize();
        $( ".text .realValue" ).hallo({editable: true});
        updatePageCss();
    }
